<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Life — Shreshtha</title>

  <script src="/auth-init.js"></script>
  <script src="/guard-auth.js"></script>

  <style>
    :root { --bg: #fafaf9; --card: #fff; --accent: #e84c88; --muted:#666; }
    body { margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; background:var(--bg); color:#222; }
    header { display:flex; align-items:center; justify-content:space-between; padding:16px 24px; background:linear-gradient(90deg,#fff,#f7f8fb); box-shadow:0 2px 8px rgba(0,0,0,0.04); }
    .brand { display:flex; align-items:center; gap:12px; }
    .brand img { width:48px; height:48px; border-radius:8px; object-fit:cover }
    h1 { margin:0; font-size:18px; }
    nav { display:flex; gap:10px; }
    .btn { background:#2e7d32;color:white;padding:8px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:600 }
    .btn.alt { background:transparent;color:#2e7d32;border:1px solid #dbe; }
    main { padding:20px 24px; max-width:1100px; margin:0 auto; }
    .grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(160px,1fr)); gap:14px; }
    .tile { position:relative; overflow:hidden; border-radius:12px; background:#fff; box-shadow:0 6px 18px rgba(20,20,20,0.04); cursor:pointer; height:160px; display:flex; align-items:center; justify-content:center; }
    .tile img { width:100%; height:100%; object-fit:cover; transition: transform .35s ease; display:block; }
    .tile:hover img { transform: scale(1.12); }
    .caption { position:absolute; left:8px; bottom:8px; background:rgba(0,0,0,0.45); color:#fff; padding:6px 8px; border-radius:8px; font-size:13px; backdrop-filter: blur(4px); }
    /* modal */
    .modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:9999; }
    .modal.open { display:flex; }
    .modal .card { max-width:90vw; max-height:90vh; border-radius:12px; overflow:hidden; background:#111; padding:12px; display:flex; gap:12px; align-items:center }
    .modal img { max-width:75vw; max-height:80vh; object-fit:contain; display:block; border-radius:8px }
    .modal .meta { color:#fff; max-width:38vw; overflow:auto }
    .close { position:absolute; right:22px; top:18px; background:transparent; border:0; color:#fff; font-size:22px; cursor:pointer; }
    footer { text-align:center; padding:18px; color:var(--muted); font-size:13px }
    @media (max-width:640px) {
      .modal img { max-width:85vw }
      .modal .meta { display:none }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="/photo1.jpg" alt="logo">
      <div>
        <h1>Shreshtha — Life</h1>
        <div style="font-size:13px;color:#666">Memories & Moments</div>
      </div>
    </div>

    <nav>
      <button class="btn" id="btnUpload">Upload</button>
      <button class="btn alt" id="btnGallery">Gallery</button>
      <button class="btn alt" id="btnLogout">Logout</button>
    </nav>
  </header>

  <main>
    <div data-guard>
      <section style="margin-bottom:18px">
        <h2 style="margin:0 0 10px">Latest Photos</h2>
        <p style="margin:0 0 12px;color:#666">Hover to zoom. Click to open full view.</p>
      </section>

      <section class="grid" id="photoGrid">
        <!-- tiles injected by JS -->
      </section>
    </div>
  </main>

  <div class="modal" id="modal">
    <button class="close" id="closeBtn">✕</button>
    <div class="card" style="background:transparent;border:none;">
      <img id="modalImg" src="" alt="photo">
      <div class="meta" id="modalMeta" style="padding:8px;">
        <h3 id="modalTitle" style="margin-top:0;color:#fff"></h3>
        <p id="modalCaption" style="color:#ddd"></p>
        <div style="margin-top:12px"><a id="downloadLink" href="#" target="_blank" style="color:#fff;text-decoration:underline">Open in new tab</a></div>
      </div>
    </div>
  </div>

  <footer>Shreshtha — Protected. Only invited users may view.</footer>

  <script>
    // photo list: uses local static photo files (photo1.jpg..photo9.jpg)
    const photos = [
      { id: "photo1", src: "/photo1.jpg", title: "Photo 1", caption: "Memorable day 1" },
      { id: "photo2", src: "/photo2.jpg", title: "Photo 2", caption: "Memorable day 2" },
      { id: "photo3", src: "/photo3.jpg", title: "Photo 3", caption: "Memorable day 3" },
      { id: "photo4", src: "/photo4.jpg", title: "Photo 4", caption: "Memorable day 4" },
      { id: "photo5", src: "/photo5.jpg", title: "Photo 5", caption: "Memorable day 5" },
      { id: "photo6", src: "/photo6.jpg", title: "Photo 6", caption: "Memorable day 6" },
      { id: "photo7", src: "/photo7.jpg", title: "Photo 7", caption: "Memorable day 7" },
      { id: "photo8", src: "/photo8.jpg", title: "Photo 8", caption: "Memorable day 8" },
      { id: "photo9", src: "/photo9.jpg", title: "Photo 9", caption: "Memorable day 9" }
    ];

    const grid = document.getElementById("photoGrid");

    function buildGrid() {
      grid.innerHTML = "";
      photos.forEach((p, i) => {
        const t = document.createElement("div");
        t.className = "tile";
        t.dataset.index = i;
        t.innerHTML = `<img src="${p.src}" alt="${p.title}"><div class="caption">${p.title}</div>`;
        t.addEventListener("click", () => openModal(i));
        grid.appendChild(t);
      });
    }

    function openModal(i) {
      const p = photos[i];
      document.getElementById("modalImg").src = p.src;
      document.getElementById("modalTitle").textContent = p.title;
      document.getElementById("modalCaption").textContent = p.caption;
      document.getElementById("downloadLink").href = p.src;
      document.getElementById("modal").classList.add("open");
    }
    function closeModal() {
      document.getElementById("modal").classList.remove("open");
      document.getElementById("modalImg").src = "";
    }

    document.getElementById("closeBtn").addEventListener("click", closeModal);
    document.getElementById("modal").addEventListener("click", (e) => {
      if (e.target === document.getElementById("modal")) closeModal();
    });

    buildGrid();

    // nav actions
    document.getElementById("btnUpload").addEventListener("click", () => window.location.href = "/upload.html");
    document.getElementById("btnGallery").addEventListener("click", () => window.location.href = "/gallery.html");
    document.getElementById("btnLogout").addEventListener("click", async () => {
      if (window.auth && window.auth.logout) {
        window.auth.logout();
      } else {
        window.location.href = "/";
      }
    });
  </script>
</body>
</html>
