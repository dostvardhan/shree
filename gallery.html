<!DOCTYPE html>
if (filtered.length === 0) {
emptyState.classList.remove('hidden');
return;
}
emptyState.classList.add('hidden');


const tpl = document.getElementById('cardTpl');
filtered.forEach(it => {
const node = tpl.content.firstElementChild.cloneNode(true);
const img = node.querySelector('img.photo');
const cap = node.querySelector('.caption');
img.src = it.img;
cap.textContent = it.quote;
node.querySelector('[data-act="download"]').addEventListener('click', () => downloadImage(it));
node.querySelector('[data-act="delete"]').addEventListener('click', () => remove(it.id));
grid.appendChild(node);
});
}


function remove(id) {
if (!confirm('Delete this item?')) return;
items = items.filter(it => it.id !== id);
save();
render();
}


function downloadImage(it) {
const a = document.createElement('a');
a.href = it.img;
const d = new Date(it.ts);
const pad = (n) => String(n).padStart(2,'0');
a.download = `photo_${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}_${pad(d.getHours())}${pad(d.getMinutes())}.jpg`;
a.click();
}


function toast(msg) {
const t = document.createElement('div');
t.className = 'toast';
t.textContent = msg;
document.body.appendChild(t);
setTimeout(() => t.classList.add('show'));
setTimeout(() => { t.classList.remove('show'); t.remove(); }, 2200);
}
</script>
</body>
</html>
