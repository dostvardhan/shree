<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Upload a Photo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Optional: your site styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Netlify Identity widget (must be included for JWT login) -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    /* Lightweight defaults in case style.css is absent */
    :root { --gap: 14px; --radius: 14px; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; background: #0b0e14; color: #eaeef5; }
    a { color: #8ab4ff; text-decoration: none; }
    header, main { max-width: 820px; margin: 0 auto; padding: 20px; }
    header { display: flex; align-items: center; justify-content: space-between; }
    .nav a { margin-right: 12px; }
    .card { background: #121826; border: 1px solid #1e2637; border-radius: var(--radius); padding: 18px; }
    .row { display: grid; gap: var(--gap); }
    .btn { background: #1f6feb; border: 0; color: #fff; border-radius: 12px; padding: 10px 16px; font-weight: 600; cursor: pointer; }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .ghost { background: transparent; border: 1px solid #2b3750; }
    .muted { color: #9fb0cc; }
    input[type="file"] { display: block; width: 100%; padding: 10px; background: #0e1422; border: 1px dashed #2b3750; border-radius: 10px; }
    .preview { display: flex; align-items: center; gap: 12px; margin-top: 10px; }
    .preview img { max-height: 120px; border-radius: 10px; border: 1px solid #2b3750; }
    pre#uploadStatus { white-space: pre-wrap; background: #0e1422; border: 1px solid #1e2637; padding: 12px; border-radius: 10px; min-height: 52px; }
    footer { opacity: 0.7; font-size: 12px; margin-top: 24px; }
  </style>
</head>

<body>
  <header>
    <div><strong>Shree</strong> · Uploader</div>
    <nav class="nav">
      <a href="index.html">Home</a>
      <a href="gallery.html">Open Gallery</a>
      <button class="btn ghost" type="button" onclick="try{ netlifyIdentity.open('login'); }catch(e){}">Login</button>
    </nav>
  </header>

  <main class="row">
    <section class="card row">
      <h1>Upload a Photo</h1>
      <p class="muted">Choose an image and click <em>Upload</em>. The file will be sent to Google Drive via your authenticated backend.</p>

      <!-- File picker -->
      <input type="file" id="fileInput" accept="image/*" />

      <!-- Optional: quick preview -->
      <div class="preview" id="preview" style="display:none;">
        <img id="previewImg" alt="Preview" />
        <span id="previewMeta" class="muted"></span>
      </div>

      <!-- Actions -->
      <div class="row" style="grid-template-columns: 160px 1fr;">
        <button id="uploadBtn" type="button" class="btn">Upload</button>
        <div></div>
      </div>

      <!-- Status / responses -->
      <pre id="uploadStatus"></pre>

      <footer class="muted">Tip: You must be logged in. If prompted, finish login and try again.</footer>
    </section>
  </main>

  <!-- Your uploader logic (must live at repo root next to this file) -->
  <script src="upload.js"></script>

  <!-- Small helper just for preview (doesn't affect token/auth) -->
  <script>
    (function () {
      const input = document.getElementById('fileInput');
      const wrap = document.getElementById('preview');
      const img  = document.getElementById('previewImg');
      const meta = document.getElementById('previewMeta');

      input.addEventListener('change', () => {
        const f = input.files && input.files[0];
        if (!f) { wrap.style.display = 'none'; return; }
        meta.textContent = `${f.name} • ${Math.round(f.size/1024)} KB • ${f.type || 'file'}`;
        if (f.type && f.type.startsWith('image/')) {
          const url = URL.createObjectURL(f);
          img.src = url;
          wrap.style.display = 'flex';
        } else {
          wrap.style.display = 'none';
        }
      });
    })();
  </script>
</body>
</html>
