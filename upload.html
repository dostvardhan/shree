<script>
  netlifyIdentity.init();

  function showUpload() {
    document.getElementById("upload-section").classList.remove("hidden");
    document.getElementById("login-section").classList.add("hidden");
  }

  function showLogin() {
    document.getElementById("upload-section").classList.add("hidden");
    document.getElementById("login-section").classList.remove("hidden");
  }

  const user = netlifyIdentity.currentUser();
  if(user) {
    showUpload();  // Logged in → show upload form
  } else {
    showLogin();   // Logged out → show login button
  }

  netlifyIdentity.on('login', user => showUpload());
  netlifyIdentity.on('logout', () => showLogin());
  document.getElementById('login-btn').addEventListener('click', () => netlifyIdentity.open());
</script>
