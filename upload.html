<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Upload</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f4f4f4;margin:0;padding:20px}
    input,button{margin:6px;padding:8px}
  </style>
  <script src="https://cdn.auth0.com/js/auth0-spa-js/1.19/auth0-spa-js.production.js" defer></script>
  <script defer>
  (function(){
    const AUTH0_DOMAIN="dev-zzhjbmtzoxtgoz31.us.auth0.com";
    const AUTH0_CLIENT_ID="0glcwUr7ZZ9sbBTBPiUPahEqqwUcuzfR";
    const AUTH0_AUDIENCE="https://shree-drive.onrender.com";
    window.__AUTH_READY__=(async function init(){
      const auth0=await createAuth0Client({domain:AUTH0_DOMAIN,client_id:AUTH0_CLIENT_ID,audience:AUTH0_AUDIENCE,cacheLocation:"memory"});
      window.__AUTH__={isAuthenticated:()=>auth0.isAuthenticated(),login:()=>auth0.loginWithRedirect({redirect_uri:window.location.href}),logout:()=>auth0.logout({returnTo:window.location.origin}),getUser:()=>auth0.getUser(),getToken:()=>auth0.getTokenSilently(),authFetch:async(u,o={})=>{const t=await auth0.getTokenSilently();const h=new Headers(o.headers||{});h.set("Authorization","Bearer "+t);return fetch(u,{...o,headers:h})}};
      return window.__AUTH__;
    })();
  })();
  </script>
</head>
<body>
  <h1>Upload Photo ðŸ“¤</h1>
  <form id="upload-form">
    <input type="file" id="file-input" required/>
    <button type="submit">Upload</button>
  </form>
  <div id="status"></div>
  <button id="logout-btn">Logout</button>

  <script>
  (async function(){
    const auth=await window.__AUTH_READY__;
    if(!await auth.isAuthenticated()){await auth.login();return;}
    document.getElementById("logout-btn").onclick=()=>auth.logout();

    document.getElementById("upload-form").onsubmit=async(e)=>{
      e.preventDefault();
      const f=document.getElementById("file-input").files[0];
      if(!f) return;
      const fd=new FormData(); fd.append("file",f);
      const res=await auth.authFetch("https://shree-drive.onrender.com/upload",{method:"POST",body:fd});
      document.getElementById("status").textContent="Upload: "+res.status;
    };
  })();
  </script>
</body>
</html>
