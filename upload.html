<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Upload Photo</title>
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
<style>
body{font-family:'Segoe UI',sans-serif;padding:20px;text-align:center;}
input, textarea, button{margin:10px 0;padding:10px;font-size:16px;width:300px;}
</style>
</head>
<body>

<h1>Upload New Photo & Quote</h1>

<input type="file" id="photo" accept="image/*"><br>
<textarea id="quote" placeholder="Enter quote..." rows="3"></textarea><br>
<button id="uploadBtn">Upload</button>

<script>
if (window.netlifyIdentity) {
    window.netlifyIdentity.on('init', user => {
        if (!user) window.location.href = "/";
    });
}

document.getElementById('uploadBtn').addEventListener('click', async () => {
    const file = document.getElementById('photo').files[0];
    const quote = document.getElementById('quote').value.trim();
    if(!file || !quote){ alert("Select photo & enter quote"); return; }

    const formData = new FormData();
    formData.append("file", file);
    formData.append("quote", quote);

    const res = await fetch('/.netlify/functions/uploadPhoto', {
        method: 'POST',
        body: formData
    });

    const result = await res.json();
    if(result.success) alert("Uploaded successfully!"); 
    else alert("Upload failed: " + result.error);
});
</script>

</body>
</html>
