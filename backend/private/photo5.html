<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sweet Memory 5 – Shreshtha</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Auth0 init + guard (same as photo1–4) -->
  <script src="js/auth-init.js"></script>
  <script src="js/guard-auth.js"></script>

  <style>
    :root {
      --bg1: #ffe2c2;
      --bg2: #ffb27a;
      --card-bg: #fff3e6;
      --accent: #ff8c5a;
      --accent-dark: #f56a3f;
      --text-main: #4a2a2a;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      min-height: 100vh;
      background: radial-gradient(circle at top, var(--bg1), var(--bg2));
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-main);
      overflow: hidden;
      position: relative;
    }

    #protected-content {
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    body.auth-ready #protected-content {
      opacity: 1;
    }

    canvas#heart-canvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    .memory-wrapper {
      position: relative;
      z-index: 1;
      background: rgba(255, 247, 240, 0.92);
      border-radius: 32px;
      padding: 26px 24px 30px;
      box-shadow: 0 18px 45px rgba(208, 103, 63, 0.25);
      max-width: 420px;
      width: 90%;
      text-align: center;
      backdrop-filter: blur(6px);
    }

    .header-text {
      font-size: 1.1rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--accent-dark);
      margin-bottom: 6px;
    }

    .title {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 14px;
    }

    .nav-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .nav-heart {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      border: 2px solid var(--accent);
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      font-size: 0.9rem;
      background: #fff6ed;
      color: var(--accent-dark);
      box-shadow: 0 6px 16px rgba(245, 114, 60, 0.25);
      transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    }

    .nav-heart:hover {
      transform: translateY(-2px) scale(1.03);
      background: #ffe1ce;
      box-shadow: 0 8px 20px rgba(245, 114, 60, 0.35);
    }

    .nav-label {
      font-size: 0.8rem;
      color: #8c5a44;
    }

    .photo-frame {
      position: relative;
      border-radius: 26px;
      padding: 8px;
      background: linear-gradient(135deg, #ffbe88, #ff9e6f);
      box-shadow: 0 16px 28px rgba(219, 116, 64, 0.38);
      margin-bottom: 14px;
    }

    .photo-frame img {
      display: block;
      width: 100%;
      border-radius: 20px;
      object-fit: cover;
      max-height: 420px;
    }

    .quote {
      margin-top: 10px;
      background: var(--card-bg);
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 0.9rem;
      color: #6c3a23;
      box-shadow: inset 0 0 0 1px rgba(255, 197, 155, 0.7);
    }

    .footer-row {
      margin-top: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      color: #7d4e36;
    }

    .logout-link {
      text-decoration: none;
      color: var(--accent-dark);
      font-weight: 600;
    }

    .logout-link:hover {
      text-decoration: underline;
    }

    /* Music heart button */
    .music-heart {
      position: fixed;
      right: 18px;
      bottom: 18px;
      width: 46px;
      height: 46px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at 30% 30%, #ffd2c8, #ff7393);
      box-shadow: 0 14px 26px rgba(203, 60, 90, 0.55);
      cursor: pointer;
      z-index: 5;
      border: none;
      outline: none;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .music-heart:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 18px 34px rgba(203, 60, 90, 0.7);
    }

    .music-heart::before,
    .music-heart::after {
      content: "";
      position: absolute;
      width: 16px;
      height: 24px;
      background: #ffffff;
      border-radius: 50% 50% 0 0;
      transform: rotate(-45deg);
      transform-origin: 50% 100%;
      top: 12px;
      left: 15px;
    }

    .music-heart::after {
      left: auto;
      right: 15px;
      transform: rotate(45deg);
    }

    .music-heart.playing {
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.11); }
      100% { transform: scale(1); }
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      border: 0;
    }

    @media (max-width: 480px) {
      .memory-wrapper {
        padding: 22px 18px 24px;
        border-radius: 26px;
      }
      .title {
        font-size: 1.4rem;
      }
      .photo-frame img {
        max-height: none;
      }
    }
  </style>
</head>
<body>
  <!-- Floating hearts canvas -->
  <canvas id="heart-canvas"></canvas>

  <div id="protected-content">
    <div class="memory-wrapper">
      <div class="header-text">Sweet Memories of Shreshtha's Life</div>
      <div class="title">Warm Glow of Your Smile</div>

      <div class="nav-row">
        <div>
          <a href="photo4.html" class="nav-heart" aria-label="Previous memory">&#10094;</a>
          <div class="nav-label">Prev</div>
        </div>
        <div>
          <a href="photo6.html" class="nav-heart" aria-label="Next memory">&#10095;</a>
          <div class="nav-label">Next</div>
        </div>
      </div>

      <div class="photo-frame">
        <img src="photo5.jpg" alt="Shreshtha smiling in an orange outfit" />
      </div>

      <div class="quote">
        “Every picture with you feels like a little festival of joy.”
      </div>

      <div class="footer-row">
        <span>Memory 5 of 9</span>
        <a href="logout.html" class="logout-link">Logout</a>
      </div>
    </div>
  </div>

  <!-- Background music -->
  <audio id="bg-music" loop preload="auto">
    <source src="assets/music.mp3" type="audio/mpeg" />
  </audio>

  <!-- Music toggle heart -->
  <button class="music-heart" id="music-toggle">
    <span class="sr-only">Toggle background music</span>
  </button>

  <script>
    // Simple floating hearts
    (function () {
      const canvas = document.getElementById("heart-canvas");
      const ctx = canvas.getContext("2d");
      let hearts = [];
      let width, height;

      function resize() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
      }
      window.addEventListener("resize", resize);
      resize();

      function createHeart() {
        return {
          x: Math.random() * width,
          y: height + Math.random() * 60,
          size: 6 + Math.random() * 7,
          speed: 0.5 + Math.random() * 1.1,
          alpha: 0.45 + Math.random() * 0.4
        };
      }

      for (let i = 0; i < 35; i++) hearts.push(createHeart());

      function drawHeart(x, y, size, alpha) {
        ctx.save();
        ctx.translate(x, y);
        ctx.scale(size / 12, size / 12);
        ctx.beginPath();
        ctx.globalAlpha = alpha;
        ctx.moveTo(0, 4);
        ctx.bezierCurveTo(-6, -4, -6, 4, 0, 10);
        ctx.bezierCurveTo(6, 4, 6, -4, 0, 4);
        ctx.fillStyle = "#ff8aa5";
        ctx.fill();
        ctx.restore();
      }

      function animate() {
        ctx.clearRect(0, 0, width, height);
        hearts.forEach(h => {
          h.y -= h.speed;
          if (h.y < -20) {
            h.x = Math.random() * width;
            h.y = height + Math.random() * 40;
          }
          drawHeart(h.x, h.y, h.size, h.alpha);
        });
        requestAnimationFrame(animate);
      }
      animate();
    })();

    // Music toggle
    (function () {
      const audio = document.getElementById("bg-music");
      const btn = document.getElementById("music-toggle");

      function toggleMusic() {
        if (audio.paused) {
          audio.play().then(() => btn.classList.add("playing")).catch(() => {});
        } else {
          audio.pause();
          btn.classList.remove("playing");
        }
      }

      btn.addEventListener("click", toggleMusic);
    })();
  </script>
</body>
</html>
