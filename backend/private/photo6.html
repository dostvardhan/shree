<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sweet Memory 6 – Shreshtha</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="js/auth-init.js"></script>
  <script src="js/guard-auth.js"></script>

  <style>
    :root {
      --bg1: #e0f9ff;
      --bg2: #c0e7ff;
      --card-bg: #f2fbff;
      --accent: #3eafc7;
      --accent-dark: #2d7e9a;
      --text-main: #23404d;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      min-height:100vh;
      background: radial-gradient(circle at top, var(--bg1), var(--bg2));
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--text-main);
      overflow:hidden;
      position:relative;
    }
    #protected-content { opacity:0; transition:opacity .4s ease; }
    body.auth-ready #protected-content { opacity:1; }
    canvas#heart-canvas {
      position:fixed; inset:0; z-index:0; pointer-events:none;
    }
    .memory-wrapper {
      position:relative; z-index:1;
      background:rgba(242,251,255,.94);
      border-radius:32px;
      padding:26px 24px 30px;
      box-shadow:0 18px 45px rgba(32,132,167,.35);
      max-width:420px; width:90%; text-align:center;
      backdrop-filter:blur(6px);
    }
    .header-text {
      font-size:1.05rem;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--accent-dark);
      margin-bottom:6px;
    }
    .title { font-size:1.6rem; font-weight:700; margin-bottom:14px; }
    .nav-row {
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom:16px;
    }
    .nav-heart {
      width:34px; height:34px; border-radius:50%;
      border:2px solid var(--accent);
      display:flex; align-items:center; justify-content:center;
      text-decoration:none; font-size:.9rem;
      background:#f3fbff;
      color:var(--accent-dark);
      box-shadow:0 6px 16px rgba(47,146,182,.28);
      transition:transform .2s ease, box-shadow .2s ease, background .2s ease;
    }
    .nav-heart:hover {
      transform:translateY(-2px) scale(1.03);
      background:#ddf3ff;
      box-shadow:0 8px 20px rgba(47,146,182,.4);
    }
    .nav-label { font-size:.8rem; color:#426676; }
    .photo-frame {
      position:relative;
      border-radius:26px;
      padding:8px;
      background:linear-gradient(135deg,#90e0ff,#64b5f6);
      box-shadow:0 16px 28px rgba(25,118,168,.35);
      margin-bottom:14px;
    }
    .photo-frame img {
      display:block; width:100%;
      border-radius:20px; object-fit:cover;
      max-height:420px;
    }
    .quote {
      margin-top:10px;
      background:var(--card-bg);
      border-radius:999px;
      padding:8px 16px;
      font-size:.9rem;
      color:#285061;
      box-shadow:inset 0 0 0 1px rgba(173,218,239,.9);
    }
    .footer-row {
      margin-top:14px;
      display:flex; justify-content:space-between; align-items:center;
      font-size:.8rem; color:#456274;
    }
    .logout-link {
      text-decoration:none;
      color:var(--accent-dark);
      font-weight:600;
    }
    .logout-link:hover { text-decoration:underline; }

    .music-heart {
      position:fixed; right:18px; bottom:18px;
      width:46px; height:46px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      background:radial-gradient(circle at 30% 30%, #e0f7ff, #4ec4ff);
      box-shadow:0 14px 26px rgba(27,135,177,.6);
      cursor:pointer; z-index:5; border:none; outline:none;
      transition:transform .2s ease, box-shadow .2s ease;
    }
    .music-heart:hover {
      transform:translateY(-2px) scale(1.04);
      box-shadow:0 18px 34px rgba(27,135,177,.75);
    }
    .music-heart::before,
    .music-heart::after {
      content:"";
      position:absolute;
      width:16px; height:24px;
      background:#ffffff;
      border-radius:50% 50% 0 0;
      transform:rotate(-45deg);
      transform-origin:50% 100%;
      top:12px; left:15px;
    }
    .music-heart::after {
      left:auto; right:15px; transform:rotate(45deg);
    }
    .music-heart.playing { animation:pulse 1s infinite; }
    @keyframes pulse {
      0%{transform:scale(1);}
      50%{transform:scale(1.11);}
      100%{transform:scale(1);}
    }
    .sr-only {
      position:absolute; width:1px; height:1px; padding:0; margin:-1px;
      overflow:hidden; clip:rect(0,0,0,0); border:0;
    }
    @media (max-width:480px) {
      .memory-wrapper { padding:22px 18px 24px; border-radius:26px; }
      .title { font-size:1.4rem; }
      .photo-frame img { max-height:none; }
    }
  </style>
</head>
<body>
  <canvas id="heart-canvas"></canvas>

  <div id="protected-content">
    <div class="memory-wrapper">
      <div class="header-text">Sweet Memories of Shreshtha's Life</div>
      <div class="title">Calm Moments, Bright Eyes</div>

      <div class="nav-row">
        <div>
          <a href="photo5.html" class="nav-heart" aria-label="Previous memory">&#10094;</a>
          <div class="nav-label">Prev</div>
        </div>
        <div>
          <a href="photo7.html" class="nav-heart" aria-label="Next memory">&#10095;</a>
          <div class="nav-label">Next</div>
        </div>
      </div>

      <div class="photo-frame">
        <img src="photo6.jpg" alt="Soft selfie of Shreshtha" />
      </div>

      <div class="quote">
        “Some smiles don’t make noise; they simply make your heart peaceful.”
      </div>

      <div class="footer-row">
        <span>Memory 6 of 9</span>
        <a href="logout.html" class="logout-link">Logout</a>
      </div>
    </div>
  </div>

  <audio id="bg-music" loop preload="auto">
    <source src="assets/music.mp3" type="audio/mpeg" />
  </audio>

  <button class="music-heart" id="music-toggle">
    <span class="sr-only">Toggle background music</span>
  </button>

  <script>
    (function () {
      const canvas = document.getElementById("heart-canvas");
      const ctx = canvas.getContext("2d");
      let hearts = [];
      let w, h;
      function resize() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
      }
      window.addEventListener("resize", resize);
      resize();
      function createHeart () {
        return {
          x: Math.random() * w,
          y: h + Math.random() * 60,
          size: 5 + Math.random() * 8,
          speed: 0.4 + Math.random() * 1.1,
          alpha: 0.4 + Math.random() * 0.4
        };
      }
      for (let i = 0; i < 32; i++) hearts.push(createHeart());
      function drawHeart(x, y, size, alpha) {
        ctx.save();
        ctx.translate(x, y);
        ctx.scale(size / 12, size / 12);
        ctx.beginPath();
        ctx.globalAlpha = alpha;
        ctx.moveTo(0, 4);
        ctx.bezierCurveTo(-6, -4, -6, 4, 0, 10);
        ctx.bezierCurveTo(6, 4, 6, -4, 0, 4);
        ctx.fillStyle = "#7cd3ff";
        ctx.fill();
        ctx.restore();
      }
      function tick() {
        ctx.clearRect(0, 0, w, h);
        hearts.forEach(hh => {
          hh.y -= hh.speed;
          if (hh.y < -20) {
            hh.x = Math.random() * w;
            hh.y = h + Math.random() * 40;
          }
          drawHeart(hh.x, hh.y, hh.size, hh.alpha);
        });
        requestAnimationFrame(tick);
      }
      tick();
    })();

    (function () {
      const audio = document.getElementById("bg-music");
      const btn = document.getElementById("music-toggle");
      function toggle() {
        if (audio.paused) {
          audio.play().then(() => btn.classList.add("playing")).catch(() => {});
        } else {
          audio.pause();
          btn.classList.remove("playing");
        }
      }
      btn.addEventListener("click", toggle);
    })();
  </script>
</body>
</html>
