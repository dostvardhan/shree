<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sweet Memory 9 – Shreshtha</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="js/auth-init.js"></script>
  <script src="js/guard-auth.js"></script>

  <style>
    :root{
      --bg1:#ffe6f2;
      --bg2:#ffc07f;
      --card-bg:#ffeff7;
      --accent:#ff8c86;
      --accent-dark:#d95e57;
      --text-main:#4d2830;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      min-height:100vh;
      background:radial-gradient(circle at top,var(--bg1),var(--bg2));
      display:flex;align-items:center;justify-content:center;
      color:var(--text-main);overflow:hidden;position:relative;
    }
    #protected-content{opacity:0;transition:opacity .4s ease;}
    body.auth-ready #protected-content{opacity:1;}
    canvas#heart-canvas{position:fixed;inset:0;z-index:0;pointer-events:none;}

    .memory-wrapper{
      position:relative;z-index:1;
      background:rgba(255,239,247,.94);
      border-radius:32px;
      padding:26px 24px 30px;
      box-shadow:0 18px 45px rgba(217,108,91,.45);
      max-width:420px;width:90%;text-align:center;
      backdrop-filter:blur(6px);
    }
    .header-text{
      font-size:1.05rem;letter-spacing:.08em;
      text-transform:uppercase;color:var(--accent-dark);
      margin-bottom:6px;
    }
    .title{font-size:1.6rem;font-weight:700;margin-bottom:14px;}
    .nav-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
    .nav-heart{
      width:34px;height:34px;border-radius:50%;
      border:2px solid var(--accent);
      display:flex;align-items:center;justify-content:center;
      text-decoration:none;font-size:.9rem;
      background:#ffe9f0;color:var(--accent-dark);
      box-shadow:0 6px 16px rgba(211,103,121,.33);
      transition:transform .2s ease,box-shadow .2s ease,background .2s ease;
    }
    .nav-heart:hover{
      transform:translateY(-2px) scale(1.03);
      background:#ffd6e6;
      box-shadow:0 8px 20px rgba(211,103,121,.5);
    }
    .nav-label{font-size:.8rem;color:#834455;}
    .photo-frame{
      position:relative;border-radius:26px;padding:8px;
      background:linear-gradient(135deg,#ffc2a5,#ff8f94);
      box-shadow:0 16px 28px rgba(205,105,100,.45);
      margin-bottom:14px;
    }
    .photo-frame img{
      display:block;width:100%;
      border-radius:20px;object-fit:cover;max-height:420px;
    }
    .quote{
      margin-top:10px;background:var(--card-bg);
      border-radius:999px;padding:8px 16px;font-size:.9rem;
      color:#6b3442;box-shadow:inset 0 0 0 1px rgba(248,185,192,.95);
    }
    .footer-row{
      margin-top:14px;display:flex;justify-content:space-between;align-items:center;
      font-size:.8rem;color:#7b3c4c;
    }
    .logout-link{text-decoration:none;color:var(--accent-dark);font-weight:600;}
    .logout-link:hover{text-decoration:underline;}

    .music-heart{
      position:fixed;right:18px;bottom:18px;
      width:46px;height:46px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      background:radial-gradient(circle at 30% 30%,#ffe3f4,#ff6e92);
      box-shadow:0 14px 26px rgba(199,71,106,.7);
      cursor:pointer;z-index:5;border:none;outline:none;
      transition:transform .2s ease,box-shadow .2s ease;
    }
    .music-heart:hover{
      transform:translateY(-2px) scale(1.04);
      box-shadow:0 18px 34px rgba(199,71,106,.85);
    }
    .music-heart::before,
    .music-heart::after{
      content:"";position:absolute;
      width:16px;height:24px;background:#ffffff;
      border-radius:50% 50% 0 0;
      transform:rotate(-45deg);transform-origin:50% 100%;
      top:12px;left:15px;
    }
    .music-heart::after{left:auto;right:15px;transform:rotate(45deg);}
    .music-heart.playing{animation:pulse 1s infinite;}
    @keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.11);}100%{transform:scale(1);}}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0;}

    @media (max-width:480px){
      .memory-wrapper{padding:22px 18px 24px;border-radius:26px;}
      .title{font-size:1.4rem;}
      .photo-frame img{max-height:none;}
    }
  </style>
</head>
<body>
  <canvas id="heart-canvas"></canvas>

  <div id="protected-content">
    <div class="memory-wrapper">
      <div class="header-text">Sweet Memories of Shreshtha's Life</div>
      <div class="title">Keep Smiling, My Sunshine</div>

      <div class="nav-row">
        <div>
          <a href="photo8.html" class="nav-heart" aria-label="Previous memory">&#10094;</a>
          <div class="nav-label">Prev</div>
        </div>
        <div>
          <a href="photo1.html" class="nav-heart" aria-label="Next memory">&#10095;</a>
          <div class="nav-label">Next</div>
        </div>
      </div>

      <div class="photo-frame">
        <img src="photo9.jpg" alt="Smiling portrait of Shreshtha" />
      </div>

      <div class="quote">
        “Your smile is that one line my heart keeps reading again and again.”
      </div>

      <div class="footer-row">
        <span>Memory 9 of 9</span>
        <a href="logout.html" class="logout-link">Logout</a>
      </div>
    </div>
  </div>

  <audio id="bg-music" loop preload="auto">
    <source src="assets/music.mp3" type="audio/mpeg" />
  </audio>

  <button class="music-heart" id="music-toggle">
    <span class="sr-only">Toggle background music</span>
  </button>

  <script>
    (function(){
      const c=document.getElementById("heart-canvas");
      const ctx=c.getContext("2d");
      let w,h;let hearts=[];
      function resize(){w=c.width=window.innerWidth;h=c.height=window.innerHeight;}
      window.addEventListener("resize",resize);resize();
      function mk(){return{x:Math.random()*w,y:h+Math.random()*60,size:6+Math.random()*7,speed:.55+Math.random()*1.1,alpha:.5+Math.random()*.35};}
      for(let i=0;i<34;i++)hearts.push(mk());
      function draw(xp,yp,s,a){
        ctx.save();ctx.translate(xp,yp);ctx.scale(s/12,s/12);
        ctx.beginPath();ctx.globalAlpha=a;
        ctx.moveTo(0,4);
        ctx.bezierCurveTo(-6,-4,-6,4,0,10);
        ctx.bezierCurveTo(6,4,6,-4,0,4);
        ctx.fillStyle="#ff98b5";ctx.fill();ctx.restore();
      }
      function loop(){
        ctx.clearRect(0,0,w,h);
        hearts.forEach(h=>{
          h.y-=h.speed;
          if(h.y<-20){h.x=Math.random()*w;h.y=h+Math.random()*40;}
          draw(h.x,h.y,h.size,h.alpha);
        });
        requestAnimationFrame(loop);
      }
      loop();
    })();

    (function(){
      const audio=document.getElementById("bg-music");
      const btn=document.getElementById("music-toggle");
      function toggle(){
        if(audio.paused){
          audio.play().then(()=>btn.classList.add("playing")).catch(()=>{});
        }else{
          audio.pause();btn.classList.remove("playing");
        }
      }
      btn.addEventListener("click",toggle);
    })();
  </script>
</body>
</html>
